<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Êº¢Â≠óË™≠„Åø„ÇØ„Ç§„Ç∫„Ç¢„Éâ„Éô„É≥„ÉÅ„É£„ÉºÔºà1Âπ¥Ôºâ</title>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-YSBGNQTYRZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-YSBGNQTYRZ');
  </script>
  
  <style>
    :root { --blue:#2563eb; --green:#16a34a; --yellow:#f59e0b; --bg:#f8fafc; }
    *, *::before, *::after { box-sizing: border-box; }
    body { margin:0; font-family: -apple-system, BlinkMacSystemFont, 'Noto Sans JP', '„É°„Ç§„É™„Ç™', Meiryo, Arial, sans-serif; background: #ffffff; color:#111827; }
    .container { max-width: 960px; margin: 0 auto; padding: 16px; }
    header h1 { margin:0 0 4px; color: var(--blue); font-size: 1.6rem; }
    .meta { color:#64748b; margin-bottom: 10px; }
    .map { position: relative; height: 120px; background: linear-gradient(90deg,#dbeafe,#fef9c3); border-radius: 12px; border:2px solid #c7d2fe; overflow:hidden; }
    .path { position:absolute; left: 12px; right: 12px; top: 50%; height: 6px; background: #93c5fd; transform: translateY(-50%); border-radius: 6px; }
    .flag { position:absolute; width: 28px; height: 28px; border-radius: 50%; background:#fde68a; border:2px solid #f59e0b; top: 50%; transform: translateY(-50%); }
    .hero { position:absolute; top: 50%; transform: translateY(-50%); width: 34px; height: 34px; background:#86efac; border:2px solid #16a34a; border-radius: 50%; display:grid; place-items:center; font-weight:700; color:#065f46; transition:left .3s ease; }
    .panel { background:#fff; border-radius: 12px; padding: 16px; margin-top: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.06); }
    .big { font-size: clamp(84px, 18vw, 180px); line-height: 1; text-align: center; margin: 8px 0 12px; user-select: none; font-weight:900; color:#111827; -webkit-text-stroke:1px rgba(0,0,0,0.06); text-rendering: optimizeLegibility; }
    .choices { display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .choice { padding: 14px 16px; font-size: 1.35rem; border: none; border-radius: 12px; background:#ffffff; color:#111827; box-shadow: 0 1px 0 rgba(0,0,0,0.04), 0 0 0 1px #475569 inset; }
    .choice:focus { outline: 3px solid #93c5fd; outline-offset: 2px; }
    .choice.correct { background:#166534; color:#ffffff; border-color:#14532d; }
    .choice.wrong { background:#991b1b; color:#ffffff; border-color:#7f1d1d; }
    .status { display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom: 6px; }
    .status .score-label { font-weight: 700; }
    #score { font-size: 1.8rem; font-weight: 800; color:#0ea5e9; }
    .feedback { min-height: 1.4em; font-size: 1.1rem; }
    .stars { position: relative; height: 0; }
    .star { position:absolute; width: 12px; height: 12px; background: radial-gradient(#fde68a,#f59e0b); border-radius:50%; animation: pop 600ms ease-out forwards; opacity:0; }
    @keyframes pop { 0%{ transform: translate(0,0) scale(.4); opacity:0} 30%{opacity:1} 100%{ transform: translate(var(--dx), var(--dy)) scale(0); opacity:0 } }
    .controls { display:flex; gap:8px; flex-wrap:wrap; }
    button { font-size:1.1rem; padding:10px 14px; border-radius:10px; border:2px solid #2563eb; background:#2563eb; color:#fff; }
    button.ghost { background:#fff; color:#2563eb; }
    @media (max-width: 420px) { .choices { grid-template-columns: 1fr; } }
  </style>
  <script>
    // „É≠„Éº„ÉûÂ≠ó„Éí„É≥„ÉàÁî®ÔºàË∂ÖÁ∞°ÊòìÔºâ
    const toRomaji = (hira) => {
      const map = { „Åç„ÇÉ:'kya', „Åç„ÇÖ:'kyu', „Åç„Çá:'kyo', „Åó„ÇÉ:'sha', „Åó„ÇÖ:'shu', „Åó„Çá:'sho', „Å°„ÇÉ:'cha', „Å°„ÇÖ:'chu', „Å°„Çá:'cho', „Åé„ÇÉ:'gya', „Åé„ÇÖ:'gyu', „Åé„Çá:'gyo', „Åò„ÇÉ:'ja', „Åò„ÇÖ:'ju', „Åò„Çá:'jo', „Å≥„ÇÉ:'bya', „Å≥„ÇÖ:'byu', „Å≥„Çá:'byo', „Å¥„ÇÉ:'pya', „Å¥„ÇÖ:'pyu', „Å¥„Çá:'pyo' };
      let s = hira;
      Object.keys(map).forEach(k=>{ s = s.replaceAll(k,map[k]); });
      const tbl = {
        „ÅÇ:'a', „ÅÑ:'i', „ÅÜ:'u', „Åà:'e', „Åä:'o', „Åã:'ka', „Åç:'ki', „Åè:'ku', „Åë:'ke', „Åì:'ko', „Åï:'sa', „Åó:'shi', „Åô:'su', „Åõ:'se', „Åù:'so',
        „Åü:'ta', „Å°:'chi', „Å§:'tsu', „Å¶:'te', „Å®:'to', „Å™:'na', „Å´:'ni', „Å¨:'nu', „Å≠:'ne', „ÅÆ:'no', „ÅØ:'ha', „Å≤:'hi', „Åµ:'fu', „Å∏:'he', „Åª:'ho',
        „Åæ:'ma', „Åø:'mi', „ÇÄ:'mu', „ÇÅ:'me', „ÇÇ:'mo', „ÇÑ:'ya', „ÇÜ:'yu', „Çà:'yo', „Çâ:'ra', „Çä:'ri', „Çã:'ru', „Çå:'re', „Çç:'ro', „Çè:'wa', „Çí:'o', „Çì:'n',
        „Åå:'ga', „Åé:'gi', „Åê:'gu', „Åí:'ge', „Åî:'go', „Åñ:'za', „Åò:'ji', „Åö:'zu', „Åú:'ze', „Åû:'zo', „Å†:'da', „Å•:'zu', „Åß:'de', „Å©:'do', „Å∞:'ba', „Å≥:'bi', „Å∂:'bu', „Åπ:'be', „Åº:'bo', „Å±:'pa', „Å¥:'pi', „Å∑:'pu', „Å∫:'pe', „ÅΩ:'po'
      };
      return s.split('').map(ch => tbl[ch] || ch).join('');
    };
  </script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Êº¢Â≠óË™≠„Åø„ÇØ„Ç§„Ç∫„Ç¢„Éâ„Éô„É≥„ÉÅ„É£„ÉºÔºà1Âπ¥Ôºâ</h1>
      <div class="meta">80Â≠ó„Åã„Çâ„É©„É≥„ÉÄ„É†10Âïè„ÄÇ„Åõ„ÅÑ„Åã„ÅÑ„Åß„Çπ„Çø„ÉºÔºÅ „Åæ„Å°„Åå„ÅÑ„ÅØ„É≠„Éº„ÉûÂ≠ó„Éí„É≥„Éà„ÄÇ</div>
    </header>

    <div class="map" aria-hidden="true">
      <div class="path"></div>
      <div class="flag" style="left: calc(100% - 28px);"></div>
      <div class="hero" id="hero" style="left: 8px;">üó∫Ô∏è</div>
    </div>

    <section class="panel" aria-live="polite">
      <div class="status">
        <div>„ÅÆ„Åì„Çä: <span id="remain">10</span></div>
        <div><span class="score-label">„Çπ„Ç≥„Ç¢:</span> <span id="score">0</span></div>
      </div>
      <div class="big" id="kanji">‰∏Ä</div>
      <div class="choices" id="choices"></div>
      <div class="feedback" id="feedback"></div>
      <div class="stars" id="stars"></div>
      <div class="controls" style="margin-top:10px">
        <button id="startBtn" class="ghost">„ÅØ„Åò„ÇÅ„Åã„Çâ</button>
        <button id="nextBtn">„Å§„Åé„Å∏</button>
      </div>
    </section>
  </div>

  <script>
    // 1Âπ¥Áîü80Â≠óÔºà„Çµ„Ç§„Éà„ÅÆgrade1„Å®Êï¥Âêà„ÄÇË™≠„Åø„ÅØ„Å≤„Çâ„Åå„Å™Ôºâ
    const G1 = [
      { kanji:'‰∏Ä', reading:'„ÅÑ„Å°' },{ kanji:'Âè≥', reading:'„Åø„Åé' },{ kanji:'Èõ®', reading:'„ÅÇ„ÇÅ' },{ kanji:'ÂÜÜ', reading:'„Åà„Çì' },{ kanji:'Áéã', reading:'„Åä„ÅÜ' },
      { kanji:'Èü≥', reading:'„Åä„Å®' },{ kanji:'‰∏ã', reading:'„Åó„Åü' },{ kanji:'ÁÅ´', reading:'„Å≤' },{ kanji:'Ëä±', reading:'„ÅØ„Å™' },{ kanji:'Ë≤ù', reading:'„Åã„ÅÑ' },
      { kanji:'Â≠¶', reading:'„Åæ„Å™„Å∂' },{ kanji:'Ê∞ó', reading:'„Åç' },{ kanji:'‰πù', reading:'„Åç„ÇÖ„ÅÜ' },{ kanji:'‰ºë', reading:'„ÇÑ„Åô„ÇÄ' },{ kanji:'Áéâ', reading:'„Åü„Åæ' },
      { kanji:'Èáë', reading:'„Åã„Å≠' },{ kanji:'Á©∫', reading:'„Åù„Çâ' },{ kanji:'Êúà', reading:'„Å§„Åç' },{ kanji:'Áä¨', reading:'„ÅÑ„Å¨' },{ kanji:'Ë¶ã', reading:'„Åø„Çã' },
      { kanji:'‰∫î', reading:'„Åî' },{ kanji:'Âè£', reading:'„Åè„Å°' },{ kanji:'Ê†°', reading:'„Åì„ÅÜ' },{ kanji:'Â∑¶', reading:'„Å≤„Å†„Çä' },{ kanji:'‰∏â', reading:'„Åï„Çì' },
      { kanji:'Â±±', reading:'„ÇÑ„Åæ' },{ kanji:'Â≠ê', reading:'„Åì' },{ kanji:'Âõõ', reading:'„Çà„Çì' },{ kanji:'Á≥∏', reading:'„ÅÑ„Å®' },{ kanji:'Â≠ó', reading:'„Åò' },
      { kanji:'ËÄ≥', reading:'„Åø„Åø' },{ kanji:'‰∏É', reading:'„Å™„Å™' },{ kanji:'Ëªä', reading:'„Åè„Çã„Åæ' },{ kanji:'Êâã', reading:'„Å¶' },{ kanji:'ÂçÅ', reading:'„Åò„ÇÖ„ÅÜ' },
      { kanji:'Âá∫', reading:'„Åß„Çã' },{ kanji:'Â•≥', reading:'„Åä„Çì„Å™' },{ kanji:'Â∞è', reading:'„Å°„ÅÑ„Åï„ÅÑ' },{ kanji:'‰∏ä', reading:'„ÅÜ„Åà' },{ kanji:'Ê£Æ', reading:'„ÇÇ„Çä' },
      { kanji:'‰∫∫', reading:'„Å≤„Å®' },{ kanji:'Ê∞¥', reading:'„Åø„Åö' },{ kanji:'Ê≠£', reading:'„Åü„Å†„Åó„ÅÑ' },{ kanji:'Áîü', reading:'„ÅÑ„Åç„Çã' },{ kanji:'Èùí', reading:'„ÅÇ„Åä' },
      { kanji:'Â§ï', reading:'„ÇÜ„ÅÜ' },{ kanji:'Áü≥', reading:'„ÅÑ„Åó' },{ kanji:'Ëµ§', reading:'„ÅÇ„Åã' },{ kanji:'ÂçÉ', reading:'„Åõ„Çì' },{ kanji:'Â∑ù', reading:'„Åã„Çè' },
      { kanji:'ÂÖà', reading:'„Åï„Åç' },{ kanji:'Êó©', reading:'„ÅØ„ÇÑ„ÅÑ' },{ kanji:'Ëçâ', reading:'„Åè„Åï' },{ kanji:'Ë∂≥', reading:'„ÅÇ„Åó' },{ kanji:'Êùë', reading:'„ÇÄ„Çâ' },
      { kanji:'Â§ß', reading:'„Åä„Åä„Åç„ÅÑ' },{ kanji:'Áî∑', reading:'„Åä„Å®„Åì' },{ kanji:'Á´π', reading:'„Åü„Åë' },{ kanji:'‰∏≠', reading:'„Å™„Åã' },{ kanji:'Ëô´', reading:'„ÇÄ„Åó' },
      { kanji:'Áî∫', reading:'„Åæ„Å°' },{ kanji:'Â§©', reading:'„Å¶„Çì' },{ kanji:'Áî∞', reading:'„Åü' },{ kanji:'Âúü', reading:'„Å§„Å°' },{ kanji:'‰∫å', reading:'„Å´' },
      { kanji:'Êó•', reading:'„Å≤' },{ kanji:'ÂÖ•', reading:'„ÅØ„ÅÑ„Çã' },{ kanji:'Âπ¥', reading:'„Å®„Åó' },{ kanji:'ÁôΩ', reading:'„Åó„Çç' },{ kanji:'ÂÖ´', reading:'„ÅØ„Å°' },
      { kanji:'Áôæ', reading:'„Å≤„ÇÉ„Åè' },{ kanji:'Êñá', reading:'„Å∂„Çì' },{ kanji:'Êú®', reading:'„Åç' },{ kanji:'Êú¨', reading:'„Åª„Çì' },{ kanji:'Âêç', reading:'„Å™' },
      { kanji:'ÁõÆ', reading:'„ÇÅ' },{ kanji:'Á´ã', reading:'„Åü„Å§' },{ kanji:'Âäõ', reading:'„Å°„Åã„Çâ' },{ kanji:'Êûó', reading:'„ÅØ„ÇÑ„Åó' },{ kanji:'ÂÖ≠', reading:'„Çç„Åè' }
    ];

    // Áä∂ÊÖã
    let pool = G1.slice();
    let current = null;
    let remain = 10;
    let score = 0;
    let answered = false;

    // ÂäπÊûúÈü≥ & Áô∫Èü≥
    let audioCtx;
    function beepOK(){
      try{ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); const o=audioCtx.createOscillator(); const g=audioCtx.createGain(); o.type='sine'; o.frequency.setValueAtTime(880,audioCtx.currentTime); g.gain.setValueAtTime(0.0001,audioCtx.currentTime); g.gain.exponentialRampToValueAtTime(0.2,audioCtx.currentTime+0.02); g.gain.exponentialRampToValueAtTime(0.0001,audioCtx.currentTime+0.25); o.connect(g).connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+0.28);}catch(e){}
    }
    function speak(text){
      if(!('speechSynthesis' in window)) return; const u = new SpeechSynthesisUtterance(text); u.lang='ja-JP'; u.rate=0.9; speechSynthesis.cancel(); speechSynthesis.speak(u);
    }

    // „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£
    function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr; }
    function sampleWrong(n, except){ const c = pool.filter(x=>x.reading!==except); const r=[]; while(r.length<Math.min(n,c.length)){ const x=c[Math.floor(Math.random()*c.length)]; if(!r.includes(x)) r.push(x);} return r; }

    // UIÂèÇÁÖß
    const hero = document.getElementById('hero');
    const remainEl = document.getElementById('remain');
    const scoreEl = document.getElementById('score');
    const kanjiEl = document.getElementById('kanji');
    const choicesEl = document.getElementById('choices');
    const feedbackEl = document.getElementById('feedback');
    const starsEl = document.getElementById('stars');
    const startBtn = document.getElementById('startBtn');
    const nextBtn = document.getElementById('nextBtn');

    function updateHero(){
      const total = 10; const done = total - remain; const left = 8 + (done/total) * (960 - 16 - 34); // 960ÂπÖÂâçÊèê„ÅßÁõ∏ÂØæÁöÑ„Å´
      hero.style.left = Math.max(8, Math.min(left, window.innerWidth - 42)) + 'px';
    }

    function popStars(){
      starsEl.innerHTML='';
      for(let i=0;i<8;i++){
        const s=document.createElement('div'); s.className='star';
        const dx = (Math.random()*120-60)+'px';
        const dy = (-Math.random()*100-20)+'px';
        s.style.setProperty('--dx', dx); s.style.setProperty('--dy', dy);
        s.style.left = (window.innerWidth/2)+'px';
        s.style.top = '0px';
        starsEl.appendChild(s);
        requestAnimationFrame(()=>{ s.style.opacity='1'; });
        setTimeout(()=> s.remove(), 700);
      }
    }

    function pick(){ current = pool[Math.floor(Math.random()*pool.length)]; }

    function renderQuestion(){
      answered=false; nextBtn.disabled=true; feedbackEl.textContent='';
      pick(); kanjiEl.textContent=current.kanji;
      // Áô∫Èü≥
      speak(current.kanji);
      // ÈÅ∏ÊäûËÇ¢
      const wrong = sampleWrong(3, current.reading).map(x=>x.reading);
      const opts = shuffle([current.reading, ...wrong]);
      choicesEl.innerHTML='';
      opts.forEach(r=>{
        const b=document.createElement('button'); b.className='choice'; b.textContent=r; b.type='button';
        b.addEventListener('click',()=>choose(b,r));
        choicesEl.appendChild(b);
      });
    }

    function choose(btn, selected){
      if(answered) return; answered=true;
      const ok = selected===current.reading;
      if(ok){
        score+=1; scoreEl.textContent=String(score); btn.classList.add('correct');
        feedbackEl.textContent='„Åõ„ÅÑ„Åã„ÅÑÔºÅ';
        beepOK(); popStars();
      }else{
        btn.classList.add('wrong');
        Array.from(choicesEl.children).forEach(c=>{ if(c.textContent===current.reading) c.classList.add('correct'); });
        feedbackEl.textContent = '„Éí„É≥„Éà: ' + toRomaji(current.reading);
      }
      nextBtn.disabled=false;
    }

    function next(){
      if(remain<=0){ feedbackEl.textContent=`„Åä„Çè„ÇäÔºÅ „Çπ„Ç≥„Ç¢: ${score}/10`; nextBtn.disabled=true; return; }
      renderQuestion(); updateHero();
    }

    function start(){ pool=G1.slice(); score=0; remain=10; answered=false; scoreEl.textContent='0'; remainEl.textContent=String(remain); updateHero(); renderQuestion(); }
    startBtn.addEventListener('click', start);
    nextBtn.addEventListener('click', ()=>{ remain-=1; remainEl.textContent=String(remain); next(); });

    // ÂàùÊúü
    start();
  </script>
</body>
</html>


